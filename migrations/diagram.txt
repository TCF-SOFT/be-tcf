Table categories {
  id uuid [pk]
  name varchar
  slug varchar
  image_url varchar
}

Table sub_categories {
  id uuid [pk]
  category_id uuid [ref: > categories.id]
  name varchar
  slug varchar [unique]
  image_url varchar
  category_slug varchar
}

Table products {
  id uuid [pk]
  bitrix_id varchar
  sub_category_id uuid [ref: > sub_categories.id]
  name varchar
  slug varchar
  cross_number varchar
  description text
  image_url varchar
  sub_category_slug varchar
  embedding vector(1536)
  is_deleted bool
}

Table offers {
  id uuid [pk]
  address_id varchar
  product_id uuid [ref: > products.id]
  brand varchar
  manufacturer_number varchar
  internal_description varchar
  price_rub numeric(12,4)
  super_wholesale_price_rub numeric(12,4)
  quantity integer
  is_deleted bool
}

Table users {
  id uuid [pk]
  email varchar
  hashed_password varchar
  is_active boolean
  is_superuser boolean
  is_verified boolean
  role varchar
  position varchar
  customer_type varchar
  mailing boolean
}

Table waybills {
  id uuid [pk]
  user_id uuid [ref: > users.id]
  type varchar
  is_pending boolean
  counterparty_name varchar
}

Table waybill_offers {
  id uuid [pk]
  waybill_id uuid [ref: > waybills.id]
  offer_id uuid [ref: > offers.id]
  quantity int
  brand varchar
  manufacturer_number varchar
  price_rub numeric
}

Table stock_movements {
  id uuid [pk]
  offer_id uuid [ref: > offers.id]
  waybill_id uuid [ref: > waybills.id]
  type varchar
  quantity int
  comment varchar
  user_id uuid [ref: > users.id]
  reverted boolean
}


Table orders {
  id uuid [pk]
  user_id uuid [ref: > users.id]
  address_id uuid
  status varchar // pending, paid, shipped, cancelled
  note text
  created_at timestamp
  updated_at timestamp
}

Table carts {
  id uuid [pk]
  user_id uuid [ref: > users.id]
  status varchar
}

Table cart_offers {
  id uuid [pk]
  user_id uuid [ref: > users.id]
  cart_id uuid [ref: > carts.id]
  quantity int
}

Table order_offers {
  id uuid [pk]
  order_id uuid [ref: > orders.id]
  offer_id uuid [ref: > offers.id]
  quantity int
  brand varchar
  manufacturer_number varchar
  price_rub numeric(12,4)
}
